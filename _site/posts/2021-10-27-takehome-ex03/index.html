<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>IS415 blog: Take Home Exercise 03</title>

<meta property="description" itemprop="description" content="Building a hedonic pricing models to explain factors affecting the resale prices of Singapore public housing."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-10-27"/>
<meta property="article:created" itemprop="dateCreated" content="2021-10-27"/>
<meta name="article:author" content="Kwek Yi Chen"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="IS415 blog: Take Home Exercise 03"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Building a hedonic pricing models to explain factors affecting the resale prices of Singapore public housing."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="IS415 blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="IS415 blog: Take Home Exercise 03"/>
<meta property="twitter:description" content="Building a hedonic pricing models to explain factors affecting the resale prices of Singapore public housing."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Take Home Exercise 03"]},{"type":"character","attributes":{},"value":["Building a hedonic pricing models to explain factors affecting the resale prices of Singapore public housing."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Kwek Yi Chen"]},{"type":"character","attributes":{},"value":["https://kwekyichen-is415.netlify.app/posts/2021-10-27-takehome-ex03/"]}]}]},{"type":"character","attributes":{},"value":["10-27-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float","number_sections","code_folding"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/aspatial/hdb_final.csv","data/aspatial/hdb_final1.csv","data/aspatial/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv","data/geospatial/MP14_SUBZONE_WEB_PL.dbf","data/geospatial/MP14_SUBZONE_WEB_PL.prj","data/geospatial/MP14_SUBZONE_WEB_PL.sbn","data/geospatial/MP14_SUBZONE_WEB_PL.sbx","data/geospatial/MP14_SUBZONE_WEB_PL.shp","data/geospatial/MP14_SUBZONE_WEB_PL.shp.xml","data/geospatial/MP14_SUBZONE_WEB_PL.shx","data/independentvar/extracted/BusStop.cpg","data/independentvar/extracted/BusStop.dbf","data/independentvar/extracted/BusStop.lyr","data/independentvar/extracted/BusStop.prj","data/independentvar/extracted/BusStop.sbn","data/independentvar/extracted/BusStop.sbx","data/independentvar/extracted/BusStop.shp","data/independentvar/extracted/BusStop.shp.xml","data/independentvar/extracted/BusStop.shx","data/independentvar/extracted/chas-clinics-geojson.geojson","data/independentvar/extracted/chas-clinics-kml.kml","data/independentvar/extracted/child-care-services-geojson.geojson","data/independentvar/extracted/child-care-services-kml.kml","data/independentvar/extracted/ELDERCARE.dbf","data/independentvar/extracted/ELDERCARE.prj","data/independentvar/extracted/ELDERCARE.sbn","data/independentvar/extracted/ELDERCARE.sbx","data/independentvar/extracted/ELDERCARE.shp","data/independentvar/extracted/ELDERCARE.shp.xml","data/independentvar/extracted/ELDERCARE.shx","data/independentvar/extracted/hawker-centres-geojson.geojson","data/independentvar/extracted/hawker-centres-kml.kml","data/independentvar/extracted/kindergartens-geojson.geojson","data/independentvar/extracted/kindergartens-kml.kml","data/independentvar/extracted/metadata-chas-clinics.txt","data/independentvar/extracted/metadata-child-care-services.txt","data/independentvar/extracted/metadata-hawker-centres.txt","data/independentvar/extracted/metadata-kindergartens.txt","data/independentvar/extracted/metadata-parks.txt","data/independentvar/extracted/metadata-supermarkets.txt","data/independentvar/extracted/MRTLRTStnPtt.CPG","data/independentvar/extracted/MRTLRTStnPtt.dbf","data/independentvar/extracted/MRTLRTStnPtt.prj","data/independentvar/extracted/MRTLRTStnPtt.sbn","data/independentvar/extracted/MRTLRTStnPtt.sbx","data/independentvar/extracted/MRTLRTStnPtt.shp","data/independentvar/extracted/MRTLRTStnPtt.shx","data/independentvar/extracted/parks-geojson.geojson","data/independentvar/extracted/parks-kml.kml","data/independentvar/extracted/Singapore+Schools-2021-10-21.csv","data/independentvar/extracted/supermarkets-geojson.geojson","data/independentvar/extracted/supermarkets-kml.kml","data/independentvar/raw/BusStopLocation.zip","data/independentvar/raw/chas-clinics.zip","data/independentvar/raw/child-care-services.zip","data/independentvar/raw/eldercare-services.zip","data/independentvar/raw/hawker-centres.zip","data/independentvar/raw/kindergartens.zip","data/independentvar/raw/parks.zip","data/independentvar/raw/pre-schools-location.zip","data/independentvar/raw/supermarkets.zip","data/newaspatial/hdb_final.csv","data/newaspatial/hdbupdated10.csv","data/newaspatial/hdbupdated11.csv","data/newaspatial/hdbupdated9.csv","takehome-ex03_files/anchor-4.2.2/anchor.min.js","takehome-ex03_files/bowser-1.9.3/bowser.min.js","takehome-ex03_files/distill-2.2.21/template.v2.js","takehome-ex03_files/figure-html5/unnamed-chunk-113-1.png","takehome-ex03_files/figure-html5/unnamed-chunk-114-1.png","takehome-ex03_files/figure-html5/unnamed-chunk-116-1.png","takehome-ex03_files/figure-html5/unnamed-chunk-121-1.png","takehome-ex03_files/figure-html5/unnamed-chunk-122-1.png","takehome-ex03_files/header-attrs-2.10/header-attrs.js","takehome-ex03_files/jquery-1.11.3/jquery.min.js","takehome-ex03_files/popper-2.6.0/popper.min.js","takehome-ex03_files/tippy-6.2.7/tippy-bundle.umd.min.js","takehome-ex03_files/tippy-6.2.7/tippy-light-border.css","takehome-ex03_files/tippy-6.2.7/tippy.css","takehome-ex03_files/tippy-6.2.7/tippy.umd.min.js","takehome-ex03_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Take Home Exercise 03","description":"Building a hedonic pricing models to explain factors affecting the resale prices of Singapore public housing.","authors":[{"author":"Kwek Yi Chen","authorURL":"https://kwekyichen-is415.netlify.app/posts/2021-10-27-takehome-ex03/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-10-27T00:00:00.000+08:00","citationText":"Chen, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">IS415 blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
Take-Home Exercise
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-06-takehome-ex01/">Take-home Exercise 1</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-16-takehome-ex02/">Take-home Exercise 2</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
In-class Exercise
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://kwekyichen-is415.netlify.app/posts/2021-08-23-in-class-exercise-2/">In-class Exercise 2</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-08-30-in-class-exercise-3/">In-class Exercise 3</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-06-in-class-exercise-4/">In-class Exercise 4</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-13-in-class-exercise-5/">In-class Exercise 5</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-20-in-class-exercise-6/">In-class Exercise 6</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Hands-on Exercise
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://kwekyichen-is415.netlify.app/posts/2021-08-30-hands-onex02/">Hands-on Exercise 2</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-08-30-hands-onex03/">Hands-on Exercise 3</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-05-hands-onex04/">Hands-on Exercise 4</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-19-hands-onex05/">Hands-on Exercise 5</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-18-hands-onex06/">Hands-on Exercise 6</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-09-26-hands-onex07/">Hands-on Exercise 7</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-10-10-hands-onex08/">Hands-on Exercise 8</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-10-18-hands-onex09/">Hands-on Exercise 9</a>
<a href="https://kwekyichen-is415.netlify.app/posts/2021-10-24-hands-onex10/">Hands-on Exercise 10</a>
</div>
</div>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Take Home Exercise 03</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Building a hedonic pricing models to explain factors affecting the resale prices of Singapore public housing.</p></p>
</div>

<div class="d-byline">
  Kwek Yi Chen <a href="https://kwekyichen-is415.netlify.app/posts/2021-10-27-takehome-ex03/" class="uri">https://kwekyichen-is415.netlify.app/posts/2021-10-27-takehome-ex03/</a> 
  
<br/>10-27-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#setting-up-the-environment">2. Setting Up the Environment</a>
<ul>
<li><a href="#installing-packages">Installing Packages</a></li>
<li><a href="#onemapsgapi-token-authorization">onemapsgapi Token Authorization</a></li>
</ul></li>
<li><a href="#data">3. Data</a></li>
<li><a href="#data-preparation">4. Data Preparation</a>
<ul>
<li><a href="#hdb-resales-data">4.1 HDB Resales Data</a></li>
<li><a href="#proximity-to-cbd">4.2 Proximity to CBD</a></li>
<li><a href="#proximity-to-eldercare">4.3 Proximity to Eldercare</a></li>
<li><a href="#proximity-to-hawker-centre">4.4 Proximity to Hawker Centre</a></li>
<li><a href="#proximity-to-mrt">4.5 Proximity to MRT</a></li>
<li><a href="#proximity-to-parks">4.6 Proximity to Parks</a></li>
<li><a href="#proximity-to-supermarket">4.7 Proximity to Supermarket</a></li>
<li><a href="#proximity-to-chas-clinics">4.8 Proximity to CHAS clinics</a></li>
<li><a href="#proximity-to-kindergartens-and-number-of-kindergartens-within-350m">4.9 Proximity to Kindergartens and Number of Kindergartens within 350m</a></li>
<li><a href="#proximity-to-childcare-centres-and-numbers-of-childcare-centres-within-350m">4.10 Proximity to childcare centres and Numbers of childcare centres within 350m</a></li>
<li><a href="#proximity-to-bus-stop-and-numbers-of-bus-stop-within-350m">4.11 Proximity to bus stop and Numbers of bus stop within 350m</a></li>
<li><a href="#numbers-of-primary-school-within-1km">4.12 Numbers of primary school within 1km</a></li>
<li><a href="#hdb-final">4.13 hdb final</a></li>
</ul></li>
<li><a href="#data-import">5. Data Import</a>
<ul>
<li><a href="#geospatial-data">5.1 Geospatial Data</a></li>
<li><a href="#aspatial-data">5.2 Aspatial data</a></li>
<li><a href="#convert-aspatial-df-to-sf">5.3 Convert aspatial df to sf</a></li>
</ul></li>
<li><a href="#eda">6. EDA</a>
<ul>
<li><a href="#statistical-graph">6.1 Statistical Graph</a></li>
<li><a href="#statiscal-point-map">6.2 Statiscal Point Map</a></li>
</ul></li>
<li><a href="#hedonic-pricing-model">7. Hedonic Pricing Model</a>
<ul>
<li><a href="#multiple-linear-regression-model">7.1 Multiple Linear Regression Model</a></li>
</ul></li>
<li><a href="#building-hedonic-pricing-models-using-gwmodel">8. Building Hedonic Pricing Models using GWmodel</a>
<ul>
<li><a href="#fixed-bandwidth-gwr-model">8.1 Fixed Bandwidth GWR model</a></li>
<li><a href="#adaptive-bandwidth-gwr-model">8.2 Adaptive Bandwidth GWR model</a></li>
</ul></li>
<li><a href="#visualising-gwr-output">9. Visualising GWR Output</a>
<ul>
<li><a href="#converting-sdf-into-sf-data.frame">9.1 Converting SDF into sf data.frame</a></li>
<li><a href="#visualing-local-r2">9.2 Visualing LOCAL R2</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="introduction">1. Introduction</h2>
<h2 id="setting-up-the-environment">2. Setting Up the Environment</h2>
<h3 id="installing-packages">Installing Packages</h3>
<p>The following code chunk install the following packages:</p>
<p>dplyr stringr: stringsub ggpubr: ggarrange dummies: create dummy var olsrr: ols_regress spdep: dnearneight()</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'readr'</span>, <span class='st'>'tmap'</span>, <span class='st'>'sf'</span>, <span class='st'>'onemapsgapi'</span>, <span class='st'>'httr'</span>, <span class='st'>'dplyr'</span>, <span class='st'>'stringr'</span>, <span class='st'>'jsonlite'</span>, <span class='st'>'tidyr'</span>, <span class='st'>'sp'</span>, <span class='st'>'dummies'</span>, <span class='st'>'geojsonio'</span>, <span class='st'>'ggplot2'</span>, <span class='st'>'ggpubr'</span>, <span class='st'>'GWmodel'</span>, <span class='st'>'corrplot'</span>, <span class='st'>'olsrr'</span>, <span class='st'>'spdep'</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<h3 id="onemapsgapi-token-authorization">onemapsgapi Token Authorization</h3>
<p>First, we set up the token for onemapsgapi. The code is not shown because the information is sensitive.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>token</span> <span class='op'>&lt;-</span> <span class='st'>"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOjc5NTMsInVzZXJfaWQiOjc5NTMsImVtYWlsIjoieWljaGVuLmt3ZWsuMjAxOUBzY2lzLnNtdS5lZHUuc2ciLCJmb3JldmVyIjpmYWxzZSwiaXNzIjoiaHR0cDpcL1wvb20yLmRmZS5vbmVtYXAuc2dcL2FwaVwvdjJcL3VzZXJcL3Nlc3Npb24iLCJpYXQiOjE2MzUxMjY5NTcsImV4cCI6MTYzNTU1ODk1NywibmJmIjoxNjM1MTI2OTU3LCJqdGkiOiJmZTAzNzU1OTc4OTI3YWQ5YzY1ZGUwOGE3N2JkYWQ0MCJ9.j9Vy1gwkKjomWfcdVVnUsNjE2OOLze0NJzxplurz-_8"</span>
</code></pre>
</div>
</details>
</div>
<h2 id="data">3. Data</h2>
<ul>
<li>HDB Resale Data. It is in csv format from data.gov.sg</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>Note that after data preparation, the state file for run each may be deleted due to Githubs file limit.</li>
</ul>
<h2 id="data-preparation">4. Data Preparation</h2>
<h3 id="hdb-resales-data">4.1 HDB Resales Data</h3>
<p>The following code chunk uses read_csv function of readr package to import the hdb resales data and display the data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv"</span><span class='op'>)</span>
<span class='va'>hdbresale</span>
</code></pre>
</div>
</details>
</div>
<p>The data contains multiple rows but our focus is only on four-room flat with transaction period from 1st January 2019 to 30th September 2020.</p>
<p>The following code chunk filter the four-room flat data from Jan 2019 to September 2020 using filter function of base package.</p>
<p>Then, we created a new column using mutate function of dplyr package for the following column:</p>
<ol type="1">
<li>address column that combines the block and street name (paste function of base package concatenate the strings, as.character converts the string to character type)</li>
<li>story_range_lower and storey_range_upper column that split the storey_range (str_sub function of stringr)</li>
<li>remaining_lease_year column from the remaining_lease string (str_sub function of stringr)</li>
<li>we selected all the columns</li>
<li>display the data.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_filtered</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>month</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2019-01"</span>, <span class='st'>"2019-02"</span>, <span class='st'>"2019-03"</span>, <span class='st'>"2019-04"</span>, <span class='st'>"2019-05"</span>, <span class='st'>"2019-06"</span>, <span class='st'>"2019-07"</span>, <span class='st'>"2019-08"</span>, <span class='st'>"2019-09"</span>, <span class='st'>"2019-10"</span>, <span class='st'>"2019-11"</span>, <span class='st'>"2019-12"</span>,<span class='st'>"2020-01"</span>, <span class='st'>"2020-02"</span>, <span class='st'>"2020-03"</span>, <span class='st'>"2020-04"</span>, <span class='st'>"2020-05"</span>, <span class='st'>"2020-06"</span>, <span class='st'>"2020-07"</span>, <span class='st'>"2020-08"</span>, <span class='st'>"2020-09"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>flat_type</span> <span class='op'>==</span> <span class='st'>"4 ROOM"</span><span class='op'>)</span>

<span class='va'>hdbresale_new</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_filtered</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>mutate</span><span class='op'>(</span><span class='va'>hdbresale_filtered</span>, address <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>block</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>street_name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>mutate</span><span class='op'>(</span><span class='va'>hdbresale_filtered</span>, storey_range_lower <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>storey_range</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>mutate</span><span class='op'>(</span><span class='va'>hdbresale_filtered</span>, storey_range_upper <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>storey_range</span>, <span class='op'>-</span><span class='fl'>3</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>mutate</span><span class='op'>(</span><span class='va'>hdbresale_filtered</span>, remaining_lease_year <span class='op'>=</span> <span class='fu'>str_sub</span><span class='op'>(</span><span class='va'>remaining_lease</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>select</span><span class='op'>(</span><span class='va'>month</span>, <span class='va'>town</span>, <span class='va'>address</span>, <span class='va'>block</span>, <span class='va'>street_name</span>, <span class='va'>flat_type</span>, <span class='va'>storey_range</span>, <span class='va'>storey_range_lower</span>, <span class='va'>storey_range_upper</span>, <span class='va'>floor_area_sqm</span>, <span class='va'>flat_model</span>, <span class='va'>lease_commence_date</span>, <span class='va'>remaining_lease</span>, <span class='va'>remaining_lease_year</span>, <span class='va'>resale_price</span><span class='op'>)</span>

<span class='va'>hdbresale_new</span>
</code></pre>
</div>
</details>
</div>
<p>We can see that from Jan 2019 to September 2020, there are 15901 transactions for four-room flat in Singapore.</p>
<p>Get lat long with address</p>
<p>The follow code chunk:</p>
<ol type="1">
<li>iterate through every rows of data in hdbresale_new table</li>
<li>for each row, we will get the address and set the onemapsgapi url</li>
<li>we will next get encode the url with URLencode function</li>
<li>get the result of the encode_url with GET function of httr package</li>
<li>extract the content from the getcoordinate request. as argument is set as parsed</li>
<li>if there are at least one result, we extract the latitude and longitude and assign it to the column respectively</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>hdbresale_new</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>address</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_new</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'address'</span><span class='op'>]</span>
  
  <span class='va'>url</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'https://developers.onemap.sg/commonapi/search?searchVal='</span>, <span class='va'>address</span>, <span class='st'>'&amp;returnGeom=Y&amp;getAddrDetails=Y&amp;pageNum=1'</span><span class='op'>)</span>
  <span class='va'>encoded_url</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/URLencode.html'>URLencode</a></span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span>
  
  <span class='va'>getcoordinate</span> <span class='op'>&lt;-</span> <span class='fu'>GET</span><span class='op'>(</span><span class='va'>encoded_url</span><span class='op'>)</span>
  
  <span class='va'>jsonParsed</span> <span class='op'>&lt;-</span> <span class='fu'>content</span><span class='op'>(</span><span class='va'>getcoordinate</span>,as<span class='op'>=</span><span class='st'>"parsed"</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>hdbresale_new</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LATITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>LATITUDE</span>
    <span class='va'>hdbresale_new</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LONGITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>LONGITUDE</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Check if any rows with missing lat long</p>
<p>The following code chunk use is.na function of base package and sum to calculate the total number of NA is there is any.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hdbresale_new</span><span class='op'>$</span><span class='va'>LATITUDE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>There are 26 rows with missing lat long. We will take a look at which areas are the affected rows</p>
<p>The following code chunk filters the rows with missing latlong</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresaleNA</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_new</span> <span class='op'>%&gt;%</span>
                 <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hdbresale_new</span><span class='op'>$</span><span class='va'>LATITUDE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>hdbresaleNA</span>
</code></pre>
</div>
</details>
</div>
<p>From the above, we can see that the common location with missing lat long is ST. GEORGE.</p>
<p>We will next assign the lat long to these rows as long as the address is ST. GEORGE if there are any result</p>
<p>Similar to previous, this time we set the address as default ST.GEORGE and assign to each row as long as there is result</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>hdbresaleNA</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>address</span> <span class='op'>=</span> <span class='st'>"ST. GEORGE"</span>
  <span class='va'>url</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'https://developers.onemap.sg/commonapi/search?searchVal='</span>, <span class='va'>address</span>, <span class='st'>'&amp;returnGeom=Y&amp;getAddrDetails=Y&amp;pageNum=1'</span><span class='op'>)</span>
  <span class='va'>encoded_url</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/URLencode.html'>URLencode</a></span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span>
  
  <span class='va'>getcoordinate</span> <span class='op'>&lt;-</span> <span class='fu'>GET</span><span class='op'>(</span><span class='va'>encoded_url</span><span class='op'>)</span>
  
  <span class='va'>jsonParsed</span> <span class='op'>&lt;-</span> <span class='fu'>content</span><span class='op'>(</span><span class='va'>getcoordinate</span>,as<span class='op'>=</span><span class='st'>"parsed"</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>hdbresaleNA</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LATITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>LATITUDE</span>
    <span class='va'>hdbresaleNA</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LONGITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>LONGITUDE</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk check if there are still any missing value</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresaleNA</span>
</code></pre>
</div>
</details>
</div>
<p>There are no missing value. However, the lat long for the 26 points are all the same.</p>
<p>In order to avoid having overlapping points, we use jitter function so that the lat long are distinct</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresaleNA</span><span class='op'>$</span><span class='va'>LATITUDE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/jitter.html'>jitter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>hdbresaleNA</span><span class='op'>$</span><span class='va'>LATITUDE</span><span class='op'>)</span>, factor <span class='op'>=</span> <span class='fl'>0.00123</span><span class='op'>)</span>
<span class='va'>hdbresaleNA</span><span class='op'>$</span><span class='va'>LONGITUDE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/jitter.html'>jitter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>hdbresaleNA</span><span class='op'>$</span><span class='va'>LONGITUDE</span><span class='op'>)</span>, factor <span class='op'>=</span> <span class='fl'>0.00123</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Check the data again</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresaleNA</span>
</code></pre>
</div>
</details>
</div>
<p>We can see that the lat long are different.</p>
<p>The following code chunk filters the rows with latlong using drop_na function of tidyr to drop rows with missing LATITUDE values</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresaleNOTNA</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_new</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>LATITUDE</span><span class='op'>)</span>
<span class='va'>hdbresaleNOTNA</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk combines hdbresaleNA and hdbresaleNOTNA using rbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_latlong</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>hdbresaleNA</span>, <span class='va'>hdbresaleNOTNA</span><span class='op'>)</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>hdbresale_latlong</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>We have 15901 rows which is same as the number of rows of the initial dataset.</p>
<p>The following code chunk converts the dataset with latlong decimal degree to metres coordinates, and transform the crs to Singapores projection, 3414.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_latlongm</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdbresale_latlong</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                               <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                    crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk plots the points to see if the data is correct using functions of tmap package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hdbresale_latlongm</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Export as csv</p>
<p>The following code chunk export data with sf as csv so that we do not have to re-run the time-consuming process above again.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdbresale_latlong</span>, <span class='st'>"data/newaspatial/hdbresale_latlongonly.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Import hdbresales csv with Latlong, and convert to singapore crs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_latlononly</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/newaspatial/hdbresale_latlongonly.csv"</span><span class='op'>)</span>

<span class='va'>hdbresale_latlongtogeo</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdbresale_latlononly</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                               <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                    crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk plots the points to check if the imported data is plotted correctly.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hdbresale_latlongtogeo</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-cbd">4.2 Proximity to CBD</h3>
<p>Since CBD is a huge area, we will first define the lat long for CBD, taken from Google. (Latitude : 1.2801, Longitude : 103.8509)</p>
<p>The following code chunk: 1) iterate through every single rows in the data 2) the start lat long, end lat long and the routeType are defined. In this analysis, we will be using routeType drive 3) the url will be set and the space in url will be removed using gsub function of base package 4) get the result of the url with GET function of httr package 5) extract the content from the getproximitytocdb request. as argument is set as parsed 6) if there are at least one result, we extract the total distance, convert it to km by dividing it by 1000, and assign it to the PROX_CBD column.</p>
<p>This process repeated a few times. This is because the onemapsgapi may return NA value for certain rows due to the request limit. Note that the first data was hdbresale_latlononly, and it was replaced by the current hdbresale_latlononly_CBD_NA_2 because of the repetition of this process.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>hdbresale_latlononly_CBD_NA3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>startlat</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_latlononly_CBD_NA3</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LATITUDE'</span><span class='op'>]</span>
  <span class='va'>startlong</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_latlononly_CBD_NA3</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LONGITUDE'</span><span class='op'>]</span>
  
  <span class='va'>start</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>' '</span>, <span class='st'>''</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>startlat</span>, <span class='st'>','</span>,  <span class='va'>startlong</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>end</span> <span class='op'>=</span> <span class='st'>'1.2801,103.8509'</span>
  <span class='va'>routeType</span> <span class='op'>=</span> <span class='st'>'drive'</span>
  
  <span class='va'>url</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>' '</span>, <span class='st'>''</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'https://developers.onemap.sg/privateapi/routingsvc/route?start='</span>, <span class='va'>start</span>, <span class='st'>'&amp;end='</span>, <span class='va'>end</span>, <span class='st'>'&amp;routeType='</span>, <span class='va'>routeType</span>, <span class='st'>'&amp;token='</span>, <span class='va'>token</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>getproximitytocbd</span> <span class='op'>&lt;-</span> <span class='fu'>GET</span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span>
  
  <span class='va'>jsonParsed</span> <span class='op'>&lt;-</span> <span class='fu'>content</span><span class='op'>(</span><span class='va'>getproximitytocbd</span>,as<span class='op'>=</span><span class='st'>"parsed"</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>route_summary</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>hdbresale_latlononly_CBD_NA3</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'PROX_CBD'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>route_summary</span><span class='op'>$</span><span class='va'>total_distance</span><span class='op'>/</span><span class='fl'>1000</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk write a copy of the csv as of the run state.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdbresale_latlononly_CBD_NA3</span>, <span class='st'>"data/newaspatial/hdbresale_PROXCBD_fifthrun.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk filter the rows with distance NA, and repeat the above code chunk to obtain distance for remaining rows with NA value.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_latlononly_CBD_NA4</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_latlononly_CBD_NA3</span> <span class='op'>%&gt;%</span>
                              <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hdbresale_latlononly_CBD_NA3</span><span class='op'>$</span><span class='va'>PROX_CBD</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>hdbresale_latlononly_CBD_NA4</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk filter the rows with valid distance value and write a copy of the csv in the file path</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_latlononly_CBD_NONA5</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_latlononly_CBD_NA3</span> <span class='op'>%&gt;%</span>
                                  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>PROX_CBD</span><span class='op'>)</span>
<span class='va'>hdbresale_latlononly_CBD_NONA5</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdbresale_latlononly_CBD_NONA5</span>, <span class='st'>"data/newaspatial/hdbresale_proxcbd5.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk rbind all the dataset after getting the PROX_CBD of every row.</p>
<p>Data to bind includes:</p>
<ul>
<li>hdbresale_latlononly_CBD_NONA1, hdbresale_latlononly_CBD_NONA2, hdbresale_latlononly_CBD_NONA3, hdbresale_latlononly_CBD_NONA4 and hdbresale_latlononly_CBD_NONA5</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_PROXCBD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>hdbresale_latlononly_CBD_NONA1</span>, <span class='va'>hdbresale_latlononly_CBD_NONA2</span>, <span class='va'>hdbresale_latlononly_CBD_NONA3</span>, <span class='va'>hdbresale_latlononly_CBD_NONA4</span>, <span class='va'>hdbresale_latlononly_CBD_NONA5</span><span class='op'>)</span>

<span class='va'>hdbresale_PROXCBD</span>

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdbresale_PROXCBD</span>, <span class='st'>"data/newaspatial/hdbresale_proxcbdfinal.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_cbd</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/newaspatial/hdbresale_proxcbdfinal.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_cbd</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>hdbresale_cbd</span><span class='op'>$</span><span class='va'>PROX_CBD</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdbresale_latlongtogeowithcbdprox</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdbresale_cbd</span>,
                                      coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                                 <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                                      crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                                      <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk plots the points to check if the imported data is plotted correctly.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hdbresale_latlongtogeowithcbdprox</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-eldercare">4.3 Proximity to Eldercare</h3>
<p>Import Eldercare data</p>
<p>The following code chunk import eldercare shapefile data using st_read.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>eldercare_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/independentvar/extracted"</span>, layer<span class='op'>=</span><span class='st'>"ELDERCARE"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Calculate distances</p>
<p>The following code chunk:</p>
<ul>
<li>get the geometry from hdb and elderlycare sf</li>
<li>retrieve coordinates in matrix form using st_coordinates function of sf package</li>
<li>calculate the Great Circle distances (longlat set to TRUE) between hdb and elderlycare</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdbresale_latlongtogeowithcbdprox</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>


<span class='va'>elderlycare_df</span> <span class='op'>&lt;-</span> <span class='va'>eldercare_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>elderlycare</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>elderlycare_df</span><span class='op'>)</span>

<span class='va'>dist_hdb_elderlycare</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>elderlycare</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_elderlycare</span>, <span class='st'>"data/newaspatial/hdbtoeldercare.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Get min distances</p>
<p>The following code chunk:</p>
<ul>
<li>converts dist_hdb_elderlycare into df</li>
<li>get the nearest Elderlycare distance for each hdb row using rowwise function of dplyr to check through a row and create a Min column using mutate function of dplyr package</li>
<li>create PROX_EDLDERCARE and filter all the min value converted into km.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_elderlycare_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_elderlycare</span><span class='op'>)</span>

<span class='va'>dist_hdb_elderlycare_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_elderlycare_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X133</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_ELDERLYCARE</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_elderlycare_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_ELDERLYCARE with the most updated data, hdbresales_cdb, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdbresale_cbd</span>, <span class='va'>PROX_ELDERLYCARE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated1.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-hawker-centre">4.4 Proximity to Hawker Centre</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hawkercentre_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/hawker-centres-geojson.geojson"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hawkercentre_sf</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_dots</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>hawkercentre_df</span> <span class='op'>&lt;-</span> <span class='va'>hawkercentre_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hawkercentre</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hawkercentre_df</span><span class='op'>)</span>
<span class='va'>hawkercentre</span> <span class='op'>&lt;-</span> <span class='va'>hawkercentre</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_hawkercentre</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>hawkercentre</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_hawkercentre</span>, <span class='st'>"data/newaspatial/hdbtohawker.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_hawkercentre_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_hawkercentre</span><span class='op'>)</span>

<span class='va'>dist_hdb_hawkercentre_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_hawkercentre_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X125</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_HAWKER</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_hawkercentre_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_HAWKER with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_HAWKER</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated2.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-mrt">4.5 Proximity to MRT</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mrtlrt_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/independentvar/extracted"</span>, layer<span class='op'>=</span><span class='st'>"MRTLRTStnPtt"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>mrtlrt_df</span> <span class='op'>&lt;-</span> <span class='va'>mrtlrt_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>mrtlrt</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>mrtlrt_df</span><span class='op'>)</span>

<span class='va'>dist_hdb_mrtlrt</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>mrtlrt</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_mrtlrt</span>, <span class='st'>"data/newaspatial/hdbtomrtlrt.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_mrtlrt_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_mrtlrt</span><span class='op'>)</span>

<span class='va'>dist_hdb_mrtlrt_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_mrtlrt_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X185</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_MRTLRT</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_mrtlrt_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_MRTLRT</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated3.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/newaspatial/hdbupdated3.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-parks">4.6 Proximity to Parks</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>parks_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/parks-geojson.geojson"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>parks_df</span> <span class='op'>&lt;-</span> <span class='va'>parks_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>parks</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>parks_df</span><span class='op'>)</span>
<span class='va'>parks</span> <span class='op'>&lt;-</span> <span class='va'>parks</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_parks</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>parks</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_parks</span>, <span class='st'>"data/newaspatial/hdbtoparks.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_parks_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_parks</span><span class='op'>)</span>

<span class='va'>dist_hdb_parks_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_parks_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X350</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_PARKS</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_parks_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_PARKS</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated4.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-supermarket">4.7 Proximity to Supermarket</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>supermarkets_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/supermarkets-geojson.geojson"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>supermarkets_df</span> <span class='op'>&lt;-</span> <span class='va'>supermarkets_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>supermarkets</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>supermarkets_df</span><span class='op'>)</span>
<span class='va'>supermarkets</span> <span class='op'>&lt;-</span> <span class='va'>supermarkets</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_supermarkets</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>supermarkets</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_supermarkets</span>, <span class='st'>"data/newaspatial/hdbtosupermarkets.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_supermarkets_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_supermarkets</span><span class='op'>)</span>

<span class='va'>dist_hdb_supermarkets_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_supermarkets_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X526</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_SUPERMARKETS</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_supermarkets_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_SUPERMARKETS</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated5.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-chas-clinics">4.8 Proximity to CHAS clinics</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clinics_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/chas-clinics-geojson.geojson"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>clinics_df</span> <span class='op'>&lt;-</span> <span class='va'>clinics_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>clinics</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>clinics_df</span><span class='op'>)</span>
<span class='va'>clinics</span> <span class='op'>&lt;-</span> <span class='va'>clinics</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_clinics</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>clinics</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_clinics</span>, <span class='st'>"data/newaspatial/hdbtoclinics.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_clinics_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_clinics</span><span class='op'>)</span>

<span class='va'>dist_hdb_clinics_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_clinics_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X1167</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_CLINICS</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_clinics_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_CLINICS</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated6.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/newaspatial/hdbupdated6.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-kindergartens-and-number-of-kindergartens-within-350m">4.9 Proximity to Kindergartens and Number of Kindergartens within 350m</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kindergartens_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/kindergartens-geojson.geojson"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>kindergartens_df</span> <span class='op'>&lt;-</span> <span class='va'>kindergartens_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>kindergartens</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>kindergartens_df</span><span class='op'>)</span>
<span class='va'>kindergartens</span> <span class='op'>&lt;-</span> <span class='va'>kindergartens</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_kindergartens</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>kindergartens</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_kindergartens</span>, <span class='st'>"data/newaspatial/hdbtokindergartens.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_kindergartens_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_kindergartens</span><span class='op'>)</span>

<span class='va'>dist_hdb_kindergartens_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_kindergartens_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X448</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_KINDERGARTENS</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_kindergartens_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_kindergartens_df</span><span class='op'>$</span><span class='va'>num_within_350m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>dist_hdb_kindergartens_df</span> <span class='op'>&lt;=</span> <span class='fl'>350</span><span class='op'>)</span>

<span class='va'>NUM_KINDERGARDEN_350M</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_kindergartens_df</span><span class='op'>$</span><span class='va'>num_within_350m</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_KINDERGARTENS</span>, <span class='va'>NUM_KINDERGARDEN_350M</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated7.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-childcare-centres-and-numbers-of-childcare-centres-within-350m">4.10 Proximity to childcare centres and Numbers of childcare centres within 350m</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>childcare_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/child-care-services-geojson.geojson"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>childcare_df</span> <span class='op'>&lt;-</span> <span class='va'>childcare_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>childcare</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>childcare_df</span><span class='op'>)</span>
<span class='va'>childcare</span> <span class='op'>&lt;-</span> <span class='va'>childcare</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_childcare</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>childcare</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_childcare</span>, <span class='st'>"data/newaspatial/hdbtochilcare.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_childcare_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_childcare</span><span class='op'>)</span>

<span class='va'>dist_hdb_childcare_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_childcare_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X1545</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_CHILDCARE</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_childcare_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_childcare_df</span><span class='op'>$</span><span class='va'>num_within_350m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>dist_hdb_childcare_df</span> <span class='op'>&lt;=</span> <span class='fl'>350</span><span class='op'>)</span>

<span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_childcare_df</span><span class='op'>$</span><span class='va'>num_within_350m</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_CHILDCARE</span>, <span class='va'>NUM_CHILDCARE_350M</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated8.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="proximity-to-bus-stop-and-numbers-of-bus-stop-within-350m">4.11 Proximity to bus stop and Numbers of bus stop within 350m</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>busstop_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/independentvar/extracted"</span>, layer<span class='op'>=</span><span class='st'>"BusStop"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>busstop_df</span> <span class='op'>&lt;-</span> <span class='va'>busstop_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>busstop</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>busstop_df</span><span class='op'>)</span>
<span class='va'>busstop</span> <span class='op'>&lt;-</span> <span class='va'>busstop</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_busstop</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>busstop</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_busstop</span>, <span class='st'>"data/newaspatial/hdbtobusstop.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_busstop_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_busstop</span><span class='op'>)</span>

<span class='va'>dist_hdb_busstop_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_busstop_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X5156</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_BUSSTOP</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_busstop_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_busstop_min</span>, <span class='st'>"data/newaspatial/hdbtobusstop_min.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_busstop_df</span><span class='op'>$</span><span class='va'>num_within_350m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>dist_hdb_busstop_df</span> <span class='op'>&lt;=</span> <span class='fl'>350</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>NUM_BUSSTOP_350M</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_busstop_df</span><span class='op'>$</span><span class='va'>num_within_350m</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_BUSSTOP</span>, <span class='va'>NUM_BUSSTOP_350M</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated9.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/newaspatial/hdbupdated9.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="numbers-of-primary-school-within-1km">4.12 Numbers of primary school within 1km</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>schools_df</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/independentvar/extracted/Singapore+Schools-2021-10-21.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Filter Primary school</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>primary_schools_df</span> <span class='op'>&lt;-</span> <span class='va'>schools_df</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>'PRIMARY SCHOOL'</span>, <span class='va'>Name</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Get Address for Primary School</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>primary_schools_df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>postalcode</span> <span class='op'>&lt;-</span> <span class='va'>primary_schools_df</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'Zip/Postal Code'</span><span class='op'>]</span>
  
  <span class='va'>url</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'https://developers.onemap.sg/commonapi/search?searchVal='</span>, <span class='va'>postalcode</span>, <span class='st'>'&amp;returnGeom=Y&amp;getAddrDetails=Y&amp;pageNum=1'</span><span class='op'>)</span>
  <span class='va'>encoded_url</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/URLencode.html'>URLencode</a></span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span>
  
  <span class='va'>getcoordinate</span> <span class='op'>&lt;-</span> <span class='fu'>GET</span><span class='op'>(</span><span class='va'>encoded_url</span><span class='op'>)</span>
  
  <span class='va'>jsonParsed</span> <span class='op'>&lt;-</span> <span class='fu'>content</span><span class='op'>(</span><span class='va'>getcoordinate</span>,as<span class='op'>=</span><span class='st'>"parsed"</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>primary_schools_df</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LATITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>LATITUDE</span>
    <span class='va'>primary_schools_df</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>'LONGITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>jsonParsed</span><span class='op'>$</span><span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>LONGITUDE</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>primary_schools_df</span><span class='op'>[</span><span class='fl'>100</span>,<span class='st'>'LATITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='st'>'1.3038033016307733'</span>
<span class='va'>primary_schools_df</span><span class='op'>[</span><span class='fl'>100</span>,<span class='st'>'LONGITUDE'</span><span class='op'>]</span> <span class='op'>=</span> <span class='st'>'103.84619018095628'</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>primary_schools_df_selected</span> <span class='op'>&lt;-</span> <span class='va'>primary_schools_df</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='st'>'Name'</span>, <span class='st'>'Address'</span>, <span class='st'>'Zip/Postal Code'</span>, <span class='st'>'LATITUDE'</span>, <span class='st'>'LONGITUDE'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>primary_schools_df_selected</span>, <span class='st'>"data/newaspatial/primaryschoollatlong.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>primary_schools_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>primary_schools_df_selected</span>,
                    coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                               <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                    crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated_geometry</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_updated</span>,
                          coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, 
                                     <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                          crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>st_transform</span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>3414</span><span class='op'>)</span>

<span class='va'>hdb_df</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated_geometry</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>hdb</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>hdb_df</span><span class='op'>)</span>

<span class='va'>prisch_df</span> <span class='op'>&lt;-</span> <span class='va'>primary_schools_sf</span><span class='op'>$</span><span class='va'>geometry</span>
<span class='va'>prisch</span> <span class='op'>&lt;-</span> <span class='fu'>st_coordinates</span><span class='op'>(</span><span class='va'>prisch_df</span><span class='op'>)</span>
<span class='va'>prisch</span> <span class='op'>&lt;-</span> <span class='va'>prisch</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>dist_hdb_prisch</span> <span class='op'>&lt;-</span> <span class='fu'>spDists</span><span class='op'>(</span><span class='va'>hdb</span>, <span class='va'>prisch</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>dist_hdb_prisch</span>, <span class='st'>"data/newaspatial/hdbtoprisch.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_prisch_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>dist_hdb_prisch</span><span class='op'>)</span>

<span class='va'>dist_hdb_prisch_min</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_prisch_df</span> <span class='op'>%&gt;%</span> <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'>c_across</span><span class='op'>(</span><span class='va'>X1</span><span class='op'>:</span><span class='va'>X156</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>PROX_PRISCH</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_prisch_min</span><span class='op'>$</span><span class='va'>Min</span><span class='op'>/</span><span class='fl'>1000</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist_hdb_prisch_df</span><span class='op'>$</span><span class='va'>num_within_1km</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='va'>dist_hdb_prisch_df</span> <span class='op'>&lt;=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='va'>NUM_PRISCH_1KM</span> <span class='op'>&lt;-</span> <span class='va'>dist_hdb_prisch_df</span><span class='op'>$</span><span class='va'>num_within_1km</span>
</code></pre>
</div>
</details>
</div>
<p>Combine data</p>
<p>The following code chunk combines PROX_MRTLRT with the most updated data, hdb_updated, via cbind function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='va'>PROX_PRISCH</span>, <span class='va'>NUM_PRISCH_1KM</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='st'>"data/newaspatial/hdbupdated10.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="hdb-final">4.13 hdb final</h3>
<p>The following code chunk creates dummy variable for storey_range column using dummy function of dummies package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_updated1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_updated</span>, <span class='fu'>dummy</span><span class='op'>(</span><span class='va'>hdb_updated</span><span class='op'>$</span><span class='va'>storey_range</span>, sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
</div>
<p>The following code chunk replace the dummys column name from hdb_updated_01 TO 03 format to 01TO03 format using gsub function of base package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>hdb_updated1</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"hdb_updated_"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>hdb_updated1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>hdb_updated1</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>" "</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>hdb_updated1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_updated1</span>, <span class='st'>"data/newaspatial/hdbupdated11.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk then select all the require column in hdb_final using select function</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final</span> <span class='op'>&lt;-</span> <span class='va'>hdb_updated1</span> <span class='op'>%&gt;%</span>
            <span class='fu'>select</span><span class='op'>(</span><span class='va'>address</span>, <span class='va'>storey_range</span>, <span class='va'>LATITUDE</span>, <span class='va'>LONGITUDE</span>, <span class='va'>resale_price</span>, <span class='va'>floor_area_sqm</span>, <span class='va'>remaining_lease_year</span>, <span class='va'>PROX_CBD</span>, <span class='va'>PROX_ELDERLYCARE</span>, <span class='va'>PROX_HAWKER</span>, <span class='va'>PROX_MRTLRT</span>, <span class='va'>PROX_PARKS</span>, <span class='va'>PROX_SUPERMARKETS</span>, <span class='va'>PROX_CLINICS</span>, <span class='va'>NUM_KINDERGARDEN_350M</span>, <span class='va'>NUM_CHILDCARE_350M</span>, <span class='va'>NUM_BUSSTOP_350M</span>, <span class='va'>NUM_PRISCH_1KM</span>, <span class='va'>`01TO03`</span>, <span class='va'>`04TO06`</span>, <span class='va'>`07TO09`</span>, <span class='va'>`10TO12`</span>, <span class='va'>`13TO15`</span>, <span class='va'>`16TO18`</span>, <span class='va'>`19TO21`</span>, <span class='va'>`22TO24`</span>, <span class='va'>`25TO27`</span>, <span class='va'>`28TO30`</span>, <span class='va'>`31TO33`</span>, <span class='va'>`34TO36`</span>, <span class='va'>`37TO39`</span>, <span class='va'>`40TO42`</span>, <span class='va'>`43TO45`</span>, <span class='va'>`46TO48`</span>, <span class='va'>`49TO51`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk save hdb_final as csv using write.csv function</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>hdb_final</span>, <span class='st'>"data/aspatial/hdb_final1.csv"</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="data-import">5. Data Import</h2>
<h3 id="geospatial-data">5.1 Geospatial Data</h3>
<p>The following code chunk import MP14_SUBZONE_WEB_PL using st_read function of sf package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz</span> <span class='op'>=</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"data/geospatial"</span>, layer <span class='op'>=</span> <span class='st'>"MP14_SUBZONE_WEB_PL"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The following code chunk update the EPSG code 3414 using st_transform of sf package and retrieve coordinate using st_crs of sf package</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mpsz_svy21</span> <span class='op'>&lt;-</span> <span class='fu'>st_transform</span><span class='op'>(</span><span class='va'>mpsz</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>mpsz_svy21</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>We can see that the EPSG is 3414 which is correct.</p>
<h3 id="aspatial-data">5.2 Aspatial data</h3>
<p>hdb_final</p>
<p>The following code chunk read hdb_final csv file as tibble data frame using read_csv function and glimpse to display the data</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/aspatial/hdb_final.csv"</span><span class='op'>)</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>hdb_final</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>We can see that there are 15901 rows of data with 35 columns. The coordinate is in LATITUDE and LONGITUDE format.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final</span> <span class='op'>&lt;-</span> <span class='va'>hdb_final</span> <span class='op'>%&gt;%</span> 
                <span class='fu'>rename</span><span class='op'>(</span>
                  storey01TO03 <span class='op'>=</span> <span class='va'>`01TO03`</span>,
                  storey04TO06 <span class='op'>=</span> <span class='va'>`04TO06`</span>,
                  storey07TO09 <span class='op'>=</span> <span class='va'>`07TO09`</span>,
                  storey10TO12 <span class='op'>=</span> <span class='va'>`10TO12`</span>,
                  storey13TO15 <span class='op'>=</span> <span class='va'>`13TO15`</span>,
                  storey16TO18 <span class='op'>=</span> <span class='va'>`16TO18`</span>,
                  storey19TO21 <span class='op'>=</span> <span class='va'>`19TO21`</span>,
                  storey22TO24 <span class='op'>=</span> <span class='va'>`22TO24`</span>,
                  storey25TO27 <span class='op'>=</span> <span class='va'>`25TO27`</span>,
                  storey28TO30 <span class='op'>=</span> <span class='va'>`28TO30`</span>,
                  storey31TO33 <span class='op'>=</span> <span class='va'>`31TO33`</span>,
                  storey34TO36 <span class='op'>=</span> <span class='va'>`34TO36`</span>,
                  storey37TO39 <span class='op'>=</span> <span class='va'>`37TO39`</span>,
                  storey40TO42 <span class='op'>=</span> <span class='va'>`40TO42`</span>,
                  storey43TO45 <span class='op'>=</span> <span class='va'>`43TO45`</span>,
                  storey46TO48 <span class='op'>=</span> <span class='va'>`46TO48`</span>,
                  storey49TO51 <span class='op'>=</span> <span class='va'>`49TO51`</span>
                  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="convert-aspatial-df-to-sf">5.3 Convert aspatial df to sf</h3>
<p>The following code chunk converts hdb_final dataframe into sf dataframe using st_as_sf function of sf package. The coordinate is then converted into svy21 EPSG:3414 FROM WGS84 usign st_transform function.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_sf</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>hdb_final</span>,
                            coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LONGITUDE"</span>, <span class='st'>"LATITUDE"</span><span class='op'>)</span>,
                            crs<span class='op'>=</span><span class='fl'>4326</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>st_transform</span><span class='op'>(</span>crs<span class='op'>=</span><span class='fl'>3414</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>hdb_final_sf</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="eda">6. EDA</h2>
<h3 id="statistical-graph">6.1 Statistical Graph</h3>
<p>Resale Price</p>
<p>The following code chunk plots the distribution of resale_price using ggplot function of ggplot2 package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`resale_price`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>From the above, we can see a normal distribution. Majority of the four room hdb were transacted for about $300000 to 400000.</p>
<p>Other variables</p>
<p>Next, we are interested to see the distribution of other variables.</p>
<p>The following code chunk plots the distribution of other variables using ggplot function of ggplot2 package and arrange them in columns of 3 using ggarrange function of ggpubr package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>floor_area_sqm</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`floor_area_sqm`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>remaining_lease_year</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`remaining_lease_year`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_CBD</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_CBD`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_ELDERLYCARE</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_ELDERLYCARE`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_HAWKER</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_HAWKER`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_MRTLRT</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_MRTLRT`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_PARKS</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_PARKS`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_SUPERMARKETS</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_SUPERMARKETS`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='va'>PROX_CLINICS</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>hdb_final_sf</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>`PROX_CLINICS`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span>bins<span class='op'>=</span><span class='fl'>20</span>, color<span class='op'>=</span><span class='st'>"black"</span>, fill<span class='op'>=</span><span class='st'>"light blue"</span><span class='op'>)</span>

<span class='fu'>ggarrange</span><span class='op'>(</span><span class='va'>floor_area_sqm</span>, <span class='va'>remaining_lease_year</span>, <span class='va'>PROX_CBD</span>, <span class='va'>PROX_ELDERLYCARE</span>, <span class='va'>PROX_HAWKER</span>, <span class='va'>PROX_MRTLRT</span>, <span class='va'>PROX_PARKS</span>, <span class='va'>PROX_SUPERMARKETS</span>, <span class='va'>PROX_CLINICS</span>, ncol <span class='op'>=</span> <span class='fl'>3</span>, nrow <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>From the above, we can see that most of the variables are normally distributed except remaining_lease_year. Majority of the transacted four-room hdb has remaining_lease_year of above 90 years.</p>
<h3 id="statiscal-point-map">6.2 Statiscal Point Map</h3>
<p>Resale Price</p>
<p>The following code chunk plots the resale price on an interactive mode with OpenStreetMap basemap using function of tmap package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hdb_final_sf</span><span class='op'>)</span> <span class='op'>+</span>  
  <span class='fu'>tm_dots</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"resale_price"</span>,
          alpha <span class='op'>=</span> <span class='fl'>0.6</span>,
          style<span class='op'>=</span><span class='st'>"quantile"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_view</span><span class='op'>(</span>set.zoom.limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>11</span>,<span class='fl'>14</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>From the interactive map, we can see that hdb in central and south area tends to have higher resale price (darker red points).</p>
<h2 id="hedonic-pricing-model">7. Hedonic Pricing Model</h2>
<h3 id="multiple-linear-regression-model">7.1 Multiple Linear Regression Model</h3>
<h4 id="relationship-between-independent-variables">7.1.1 Relationship between Independent variables</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>corrplot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>hdb_final</span><span class='op'>[</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>35</span><span class='op'>]</span><span class='op'>)</span>, diag <span class='op'>=</span> <span class='cn'>FALSE</span>, order <span class='op'>=</span> <span class='st'>"AOE"</span>,
         tl.pos <span class='op'>=</span> <span class='st'>"td"</span>, tl.cex <span class='op'>=</span> <span class='fl'>0.7</span>, number.cex<span class='op'>=</span><span class='fl'>0.5</span>, method <span class='op'>=</span> <span class='st'>"number"</span>, type <span class='op'>=</span> <span class='st'>"upper"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>From the scatterplot above, we can see that NUM_BUSSTOP_350M is highly correlated to NUM_CHILDCARE_350M and NUM_KINDERGARDEN_350M with correlation coefficient of 0.93 and 0.84 respective. NUM_CHILDCARE_350M and NUM_KINDERGARDEN_350M are also highly correlated with correlation coefficient of 0.84. Hence, we should only include one out of three of them in the subsequent model building. Hence, NUM_BUSSTOP_350M and NUM_KINDERGARDEN_350M will be excluded.</p>
<h4 id="hedonic-pricing-model-using-multiple-linear-regression-method">7.1.2 Hedonic pricing model using multiple linear regression method</h4>
<p>The following code chunk builds a multiple linear regression model using lm function of stats package.</p>
<p>Note that <code>49TO51</code> dummy variable is excluded since because we should only have n-1 dummy variable. It will have a strong correlation with other independent variable if we were to include it.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_mlr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span> <span class='va'>PROX_MRTLRT</span> <span class='op'>+</span> <span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>PROX_SUPERMARKETS</span> <span class='op'>+</span> <span class='va'>PROX_CLINICS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>NUM_PRISCH_1KM</span> <span class='op'>+</span> <span class='va'>storey01TO03</span> <span class='op'>+</span> <span class='va'>storey04TO06</span> <span class='op'>+</span> <span class='va'>storey07TO09</span> <span class='op'>+</span> <span class='va'>storey10TO12</span> <span class='op'>+</span> <span class='va'>storey13TO15</span> <span class='op'>+</span> <span class='va'>storey16TO18</span> <span class='op'>+</span> <span class='va'>storey19TO21</span> <span class='op'>+</span> <span class='va'>storey22TO24</span> <span class='op'>+</span> <span class='va'>storey25TO27</span> <span class='op'>+</span> <span class='va'>storey28TO30</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span> <span class='op'>+</span> <span class='va'>storey43TO45</span> <span class='op'>+</span> <span class='va'>storey46TO48</span>, data<span class='op'>=</span><span class='va'>hdb_final_sf</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>hdb_final_mlr</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>From the above, we can see that there are some independent variables that are statistically not significant. Variables such as PROX_MRTLRT, PROX_SUPERMARKETS, PROX_CLINICS, NUM_PRISCH_1KM, storey43TO45 and storey46TO48 have p-value above 0.05 and are not statistically significant. We will exclude these variable when we calibrate the revised model.</p>
<p>The code chunk calibrate the revised model using lm function with variables that are not statistically significant removed. Ordinary least squares regression is then done by running ols_regress function of olsrr package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_mlr1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span> <span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>storey01TO03</span> <span class='op'>+</span> <span class='va'>storey04TO06</span> <span class='op'>+</span> <span class='va'>storey07TO09</span> <span class='op'>+</span> <span class='va'>storey10TO12</span> <span class='op'>+</span> <span class='va'>storey13TO15</span> <span class='op'>+</span> <span class='va'>storey16TO18</span> <span class='op'>+</span> <span class='va'>storey19TO21</span> <span class='op'>+</span> <span class='va'>storey22TO24</span> <span class='op'>+</span> <span class='va'>storey25TO27</span> <span class='op'>+</span> <span class='va'>storey28TO30</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span>, data<span class='op'>=</span><span class='va'>hdb_final_sf</span><span class='op'>)</span>

<span class='fu'>ols_regress</span><span class='op'>(</span><span class='va'>hdb_final_mlr1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h4 id="checks-for-multicolinearity">7.1.3 Checks for multicolinearity</h4>
<p>The following code chunk test for sign of multicolinearity using ols_vif_tol function of olsrr package.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>hdb_final_mlr1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ols_vif_tol</span><span class='op'>(</span><span class='va'>hdb_final_mlr1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>There are some independent variables with VIF value above 10 which means that there are sign of multicollinearity. Hence we would want to calibrate the model again by removing independent variables with VIF above 10.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_mlr2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span> <span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span>, data<span class='op'>=</span><span class='va'>hdb_final_sf</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ols_regress</span><span class='op'>(</span><span class='va'>hdb_final_mlr2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h4 id="test-for-non-linearity">7.1.4 Test for Non-Linearity</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ols_plot_resid_fit</span><span class='op'>(</span><span class='va'>hdb_final_mlr2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h4 id="test-for-normality-assumption">7.1.5 Test for Normality Assumption</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ols_plot_resid_hist</span><span class='op'>(</span><span class='va'>hdb_final_mlr2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h4 id="testing-for-spatial-autocorrelation">7.1.6 Testing for Spatial Autocorrelation</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mlr.output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>hdb_final_mlr2</span><span class='op'>$</span><span class='va'>residuals</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_res_sf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_final_sf</span>, <span class='va'>hdb_final_mlr2</span><span class='op'>$</span><span class='va'>residuals</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>rename</span><span class='op'>(</span>`MLR_RES` <span class='op'>=</span> <span class='va'>`hdb_final_mlr2.residuals`</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as_Spatial</span><span class='op'>(</span><span class='va'>hdb_final_res_sf</span><span class='op'>)</span>
<span class='va'>hdb_final_sp</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hdb_final_res_sf</span><span class='op'>)</span> <span class='op'>+</span>  
  <span class='fu'>tm_dots</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"MLR_RES"</span>,
          alpha <span class='op'>=</span> <span class='fl'>0.6</span>,
          style<span class='op'>=</span><span class='st'>"quantile"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_view</span><span class='op'>(</span>set.zoom.limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>11</span>,<span class='fl'>14</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_basemap</span><span class='op'>(</span><span class='st'>"OpenStreetMap"</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nb</span> <span class='op'>&lt;-</span> <span class='fu'>dnearneigh</span><span class='op'>(</span><span class='fu'>coordinates</span><span class='op'>(</span><span class='va'>hdb_final_sp</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>1500</span>, longlat <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nb</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nb_lw</span> <span class='op'>&lt;-</span> <span class='fu'>nb2listw</span><span class='op'>(</span><span class='va'>nb</span>, style <span class='op'>=</span> <span class='st'>'W'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nb_lw</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lm.morantest</span><span class='op'>(</span><span class='va'>hdb_final_mlr2</span>, <span class='va'>nb_lw</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="building-hedonic-pricing-models-using-gwmodel">8. Building Hedonic Pricing Models using GWmodel</h2>
<h3 id="fixed-bandwidth-gwr-model">8.1 Fixed Bandwidth GWR model</h3>
<h4 id="computing-fixed-bandwidth">8.1.1 Computing fixed bandwidth</h4>
<p>longlat set to TRUE since the data preparation also use great circle distances.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bw.fixed</span> <span class='op'>&lt;-</span> <span class='fu'>bw.gwr</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span>
<span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span>, data<span class='op'>=</span><span class='va'>hdb_final_sp</span>, approach<span class='op'>=</span><span class='st'>"CV"</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span>, adaptive<span class='op'>=</span><span class='cn'>FALSE</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h4 id="gwmodel-method---fixed-bandwith">8.1.2 GWModel method - fixed bandwith</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gwr.fixed</span> <span class='op'>&lt;-</span> <span class='fu'>gwr.basic</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span>
<span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span>, data<span class='op'>=</span><span class='va'>hdb_final_sp</span>, bw<span class='op'>=</span><span class='va'>bw.fixed</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span>, adaptive<span class='op'>=</span><span class='cn'>FALSE</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gwr.fixed</span>
</code></pre>
</div>
</details>
</div>
<h3 id="adaptive-bandwidth-gwr-model">8.2 Adaptive Bandwidth GWR model</h3>
<h4 id="computing-adaptive-bandwidth">8.2.1 Computing adaptive bandwidth</h4>
<p>Notice that the dummy variables name have an addition X at the front in hdb_final_sp</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bw.adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>bw.gwr</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span>
<span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span>, data<span class='op'>=</span><span class='va'>hdb_final_sp</span>, approach<span class='op'>=</span><span class='st'>"CV"</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span>, adaptive<span class='op'>=</span><span class='cn'>TRUE</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h4 id="gwmodel-method---adaptive-bandwith">8.2.2 GWModel method - adaptive bandwith</h4>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gwr.adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>gwr.basic</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>resale_price</span> <span class='op'>~</span> <span class='va'>floor_area_sqm</span> <span class='op'>+</span> <span class='va'>remaining_lease_year</span> <span class='op'>+</span> <span class='va'>PROX_CBD</span> <span class='op'>+</span> <span class='va'>PROX_ELDERLYCARE</span> <span class='op'>+</span> <span class='va'>PROX_HAWKER</span> <span class='op'>+</span>
<span class='va'>PROX_PARKS</span> <span class='op'>+</span> <span class='va'>NUM_CHILDCARE_350M</span> <span class='op'>+</span> <span class='va'>storey31TO33</span> <span class='op'>+</span> <span class='va'>storey34TO36</span> <span class='op'>+</span> <span class='va'>storey37TO39</span> <span class='op'>+</span> <span class='va'>storey40TO42</span>, data<span class='op'>=</span><span class='va'>hdb_final_sp</span>, bw<span class='op'>=</span><span class='va'>bw.adaptive</span>, kernel<span class='op'>=</span><span class='st'>"gaussian"</span>, adaptive<span class='op'>=</span><span class='cn'>TRUE</span>, longlat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gwr.adaptive</span>
</code></pre>
</div>
</details>
</div>
<h2 id="visualising-gwr-output">9. Visualising GWR Output</h2>
<h3 id="converting-sdf-into-sf-data.frame">9.1 Converting SDF into sf data.frame</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_sf.adaptive</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>gwr.adaptive</span><span class='op'>$</span><span class='va'>SDF</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs<span class='op'>=</span><span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_sf.adaptive.svy21</span> <span class='op'>&lt;-</span> <span class='fu'>st_transform</span><span class='op'>(</span><span class='va'>hdb_final_sf.adaptive</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>hdb_final_sf.adaptive.svy21</span>  
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gwr.adaptive.output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>gwr.adaptive</span><span class='op'>$</span><span class='va'>SDF</span><span class='op'>)</span>
<span class='va'>hdb_final_sf.adaptive</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_final_res_sf</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>gwr.adaptive.output</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>hdb_final_sf.adaptive</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_sf.fixed</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>gwr.fixed</span><span class='op'>$</span><span class='va'>SDF</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>st_transform</span><span class='op'>(</span>crs<span class='op'>=</span><span class='fl'>3414</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hdb_final_sf.fixed.svy21</span> <span class='op'>&lt;-</span> <span class='fu'>st_transform</span><span class='op'>(</span><span class='va'>hdb_final_sf.fixed</span>, <span class='fl'>3414</span><span class='op'>)</span>
<span class='va'>hdb_final_sf.fixed.svy21</span>  
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gwr.fixed.output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>gwr.fixed</span><span class='op'>$</span><span class='va'>SDF</span><span class='op'>)</span>
<span class='va'>hdb_final_sf.fixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>hdb_final_res_sf</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>gwr.fixed.output</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>hdb_final_sf.fixed</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="visualing-local-r2">9.2 Visualing LOCAL R2</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>mpsz_svy21</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_polygons</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tmap_options</span><span class='op'>(</span>check.and.fix <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>hdb_final_sf.fixed</span><span class='op'>)</span> <span class='op'>+</span>  
  <span class='fu'>tm_dots</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"Local_R2"</span>,
          border.col <span class='op'>=</span> <span class='st'>"gray60"</span>,
          border.lwd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_view</span><span class='op'>(</span>set.zoom.limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>11</span>,<span class='fl'>14</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>STOREY01TO03 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">01TO03</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>STOREY04TO06 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">04TO06</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>STOREY07TO09 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">07TO09</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>STOREY10TO12 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">10TO12</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>STOREY13TO15 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">13TO15</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>STOREY16TO18 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">16TO18</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>STOREY19TO21 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">19TO21</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>STOREY22TO24 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">22TO24</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>STOREY25TO27 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">25TO27</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>STOREY28TO30 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">28TO30</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>STOREY31TO33 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">31TO33</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>STOREY34TO36 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">34TO36</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>STOREY37TO39 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">37TO39</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>STOREY40TO42 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">40TO42</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>STOREY43TO45 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">43TO45</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>STOREY46TO48 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">46TO48</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>STOREY49TO51 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">49TO51</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>NUM_KINDERGARDEN_350M <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">NUM_KINDERGARDEN_350M</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>NUM_CHILDCARE_350M <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">NUM_CHILDCARE_350M</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>NUM_BUSSTOP_350M <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">NUM_BUSSTOP_350M</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>NUM_PRISCH_1KM <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>hdb_final.sf, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">NUM_PRISCH_1KM</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>STOREY01TO03, STOREY04TO06, STOREY07TO09, STOREY10TO12, STOREY13TO15, STOREY16TO18, STOREY19TO21, STOREY22TO24, STOREY25TO27, STOREY28TO30, STOREY31TO33, STOREY34TO36, STOREY37TO39, STOREY40TO42, STOREY43TO45, STOREY46TO48, STOREY49TO51</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>NUM_KINDERGARDEN_350M, NUM_CHILDCARE_350M, NUM_BUSSTOP_350M, NUM_PRISCH_1KM</span></code></pre></div>
</details>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
