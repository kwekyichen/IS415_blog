[
  {
    "path": "posts/2021-08-30-in-class-exercise-3/",
    "title": "In-class Exercise 3",
    "description": "In this hands-on exercise, I learn about percentile, box, rate and relative risk map.",
    "author": [
      {
        "name": "Kwek Yi Chen",
        "url": "https://example.com/kwekyichen"
      }
    ],
    "date": "2021-08-30",
    "categories": [],
    "contents": "\r\nGetting Started\r\nThis code chunk create a list of R packages needed and install them if they are not installed.\r\n\r\n\r\npackages = c('sf', 'tmap', 'tidyverse')\r\nfor (p in packages){\r\nif(!require(p, character.only = T)){\r\n  install.packages(p)\r\n}\r\nlibrary(p,character.only = T)\r\n}\r\n\r\n\r\n\r\n\r\nCleaning RDS file\r\nThis coded chuck reads the RDS file from the path and display the data.\r\n\r\n\r\n\r\nmpsz_pop2020 <- read_rds(“../../../IS415/Hands-on_Ex/Hands-on_Ex03/data/rds/mpszpop2020.rds”)\r\n\r\nknitr::kable(head(mpsz_pop2020)) \r\n\r\n\r\nOBJECTID\r\nSUBZONE_NO\r\nSUBZONE_N\r\nSUBZONE_C\r\nCA_IND\r\nPLN_AREA_N\r\nPLN_AREA_C\r\nREGION_N\r\nREGION_C\r\nINC_CRC\r\nFMEL_UPD_D\r\nX_ADDR\r\nY_ADDR\r\nSHAPE_Leng\r\nSHAPE_Area\r\nPA\r\nYOUNG\r\nECONOMY ACTIVE\r\nAGED\r\nTOTAL\r\nDEPENDENCY\r\ngeometry\r\n1\r\n1\r\nMARINA SOUTH\r\nMSSZ01\r\nY\r\nMARINA SOUTH\r\nMS\r\nCENTRAL REGION\r\nCR\r\n5ED7EB253F99252E\r\n2014-12-05\r\n31595.84\r\n29220.19\r\n5267.381\r\n1630379.3\r\nNA\r\nNA\r\nNA\r\nNA\r\nNA\r\nNA\r\nMULTIPOLYGON (((31495.56 30…\r\n2\r\n1\r\nPEARL’S HILL\r\nOTSZ01\r\nY\r\nOUTRAM\r\nOT\r\nCENTRAL REGION\r\nCR\r\n8C7149B9EB32EEFC\r\n2014-12-05\r\n28679.06\r\n29782.05\r\n3506.107\r\n559816.2\r\nOUTRAM\r\n930\r\n3130\r\n2120\r\n6180\r\n0.9744409\r\nMULTIPOLYGON (((29092.28 30…\r\n3\r\n3\r\nBOAT QUAY\r\nSRSZ03\r\nY\r\nSINGAPORE RIVER\r\nSR\r\nCENTRAL REGION\r\nCR\r\nC35FEFF02B13E0E5\r\n2014-12-05\r\n29654.96\r\n29974.66\r\n1740.926\r\n160807.5\r\nSINGAPORE RIVER\r\n0\r\n40\r\n10\r\n50\r\n0.2500000\r\nMULTIPOLYGON (((29932.33 29…\r\n4\r\n8\r\nHENDERSON HILL\r\nBMSZ08\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n3775D82C5DDBEFBD\r\n2014-12-05\r\n26782.83\r\n29933.77\r\n3313.625\r\n595428.9\r\nBUKIT MERAH\r\n2600\r\n7450\r\n3320\r\n13370\r\n0.7946309\r\nMULTIPOLYGON (((27131.28 30…\r\n5\r\n3\r\nREDHILL\r\nBMSZ03\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n85D9ABEF0A40678F\r\n2014-12-05\r\n26201.96\r\n30005.70\r\n2825.594\r\n387429.4\r\nBUKIT MERAH\r\n2760\r\n6160\r\n1740\r\n10660\r\n0.7305195\r\nMULTIPOLYGON (((26451.03 30…\r\n6\r\n7\r\nALEXANDRA HILL\r\nBMSZ07\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n9D286521EF5E3B59\r\n2014-12-05\r\n25358.82\r\n29991.38\r\n4428.913\r\n1030378.8\r\nBUKIT MERAH\r\n2800\r\n7340\r\n3420\r\n13560\r\n0.8474114\r\nMULTIPOLYGON (((25899.7 297…\r\n\r\nBoxplot\r\n\r\n\r\nggplot(data=mpsz_pop2020, \r\n     aes(x = \"\", \r\n         y = AGED)) +\r\ngeom_boxplot()\r\n\r\n\r\n\r\nVisualization\r\nPercentile Map\r\n\r\nExclude records with NA\r\n\r\n\r\nmpsz_pop2020a <- mpsz_pop2020 %>%\r\n  drop_na()\r\n\r\nknitr::kable(head(mpsz_pop2020a))\r\n\r\n\r\nOBJECTID\r\nSUBZONE_NO\r\nSUBZONE_N\r\nSUBZONE_C\r\nCA_IND\r\nPLN_AREA_N\r\nPLN_AREA_C\r\nREGION_N\r\nREGION_C\r\nINC_CRC\r\nFMEL_UPD_D\r\nX_ADDR\r\nY_ADDR\r\nSHAPE_Leng\r\nSHAPE_Area\r\nPA\r\nYOUNG\r\nECONOMY ACTIVE\r\nAGED\r\nTOTAL\r\nDEPENDENCY\r\ngeometry\r\n2\r\n1\r\nPEARL’S HILL\r\nOTSZ01\r\nY\r\nOUTRAM\r\nOT\r\nCENTRAL REGION\r\nCR\r\n8C7149B9EB32EEFC\r\n2014-12-05\r\n28679.06\r\n29782.05\r\n3506.107\r\n559816.2\r\nOUTRAM\r\n930\r\n3130\r\n2120\r\n6180\r\n0.9744409\r\nMULTIPOLYGON (((29092.28 30…\r\n3\r\n3\r\nBOAT QUAY\r\nSRSZ03\r\nY\r\nSINGAPORE RIVER\r\nSR\r\nCENTRAL REGION\r\nCR\r\nC35FEFF02B13E0E5\r\n2014-12-05\r\n29654.96\r\n29974.66\r\n1740.926\r\n160807.5\r\nSINGAPORE RIVER\r\n0\r\n40\r\n10\r\n50\r\n0.2500000\r\nMULTIPOLYGON (((29932.33 29…\r\n4\r\n8\r\nHENDERSON HILL\r\nBMSZ08\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n3775D82C5DDBEFBD\r\n2014-12-05\r\n26782.83\r\n29933.77\r\n3313.625\r\n595428.9\r\nBUKIT MERAH\r\n2600\r\n7450\r\n3320\r\n13370\r\n0.7946309\r\nMULTIPOLYGON (((27131.28 30…\r\n5\r\n3\r\nREDHILL\r\nBMSZ03\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n85D9ABEF0A40678F\r\n2014-12-05\r\n26201.96\r\n30005.70\r\n2825.594\r\n387429.4\r\nBUKIT MERAH\r\n2760\r\n6160\r\n1740\r\n10660\r\n0.7305195\r\nMULTIPOLYGON (((26451.03 30…\r\n6\r\n7\r\nALEXANDRA HILL\r\nBMSZ07\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n9D286521EF5E3B59\r\n2014-12-05\r\n25358.82\r\n29991.38\r\n4428.913\r\n1030378.8\r\nBUKIT MERAH\r\n2800\r\n7340\r\n3420\r\n13560\r\n0.8474114\r\nMULTIPOLYGON (((25899.7 297…\r\n7\r\n9\r\nBUKIT HO SWEE\r\nBMSZ09\r\nN\r\nBUKIT MERAH\r\nBM\r\nCENTRAL REGION\r\nCR\r\n7839A8577144EFE2\r\n2014-12-05\r\n27680.06\r\n30230.86\r\n3275.312\r\n551732.0\r\nBUKIT MERAH\r\n2750\r\n8080\r\n3610\r\n14440\r\n0.7871287\r\nMULTIPOLYGON (((27746.95 30…\r\n\r\nPercentile\r\n\r\n\r\npercent <- c(0,.01,.1,.5,.9,.99,1)\r\nvar <- mpsz_pop2020a[\"DEPENDENCY\"] %>%\r\n  st_set_geometry(NULL)\r\nquantile(var[,1], percent)\r\n\r\n\r\n        0%         1%        10%        50%        90%        99% \r\n 0.0000000  0.1377778  0.5686120  0.7024793  0.8474114  1.2100000 \r\n      100% \r\n19.0000000 \r\n\r\nCreating get variable function\r\n\r\n\r\nget.var <- function(vname,df) {\r\n  v <- df[vname] %>%\r\n    st_set_geometry(NULL)\r\n  v <- unname(v[,1])\r\n  return(v)\r\n}\r\n\r\n\r\n\r\nPlotting percentile map with tmap functions (hardcode)\r\n\r\n\r\npercent <- c(0,.01,.1,.5,.9,.99,1)\r\nvar = get.var(\"DEPENDENCY\", mpsz_pop2020a)\r\nbperc <- quantile(var,percent)\r\ntm_shape(mpsz_pop2020) + \r\n  tm_polygons() +\r\ntm_shape(mpsz_pop2020a) +\r\n  tm_fill(\"DEPENDENCY\",\r\n          title=\"DEPENDENCY\",\r\n          breaks=bperc,\r\n          palette=\"Blues\",\r\n          labels=c(\"< 1%\", \"1% - 10%\",\r\n                   \"10% - 50%\",\r\n                   \"50% - 90%\",\r\n                   \"90% - 99%\",\r\n                   \"> 99%\")) + \r\n  tm_borders() +\r\n  tm_layout(title = \"Percentile Map\", title.position = c(\"right\", \"bottom\"))\r\n\r\n\r\n\r\n\r\nPlotting percentile map with Percentile Mapping Function\r\n\r\n\r\npercentmap <- function(vnam, df, legtitle=NA, mtitle=\"Percentile Map\"){\r\n  percent <- c(0,.01,.1,.5,.9,.99,1)\r\n  var = get.var(vnam, df)\r\n  bperc <- quantile(var,percent)\r\n  tm_shape(df) + \r\n  tm_polygons() +\r\n  tm_shape(df) +\r\n    tm_fill(vnam,\r\n            title=legtitle,\r\n            breaks=bperc,\r\n            palette=\"Blues\",\r\n            labels=c(\"< 1%\", \"1% - 10%\",\r\n                     \"10% - 50%\",\r\n                     \"50% - 90%\",\r\n                     \"90% - 99%\",\r\n                     \"> 99%\")) + \r\n    tm_borders() +\r\n    tm_layout(title = mtitle, title.position = c(\"right\", \"bottom\"))\r\n}\r\n\r\n\r\n\r\nTesting Percentile Mapping Function (young)\r\n\r\n\r\nyoungmap <- percentmap(\"YOUNG\", mpsz_pop2020a)\r\nyoungmap\r\n\r\n\r\n\r\n\r\nTesting Percentile Mapping Function (aged)\r\n\r\n\r\nagedmap <- percentmap(\"YOUNG\", mpsz_pop2020a)\r\nagedmap\r\n\r\n\r\n\r\n\r\nBoxmap\r\n\r\nBoxbreaks Function\r\n\r\n\r\nboxbreaks <- function(v,mult=1.5) {\r\n  qv <- unname(quantile(v))\r\n  iqr <- qv[4] - qv[2]\r\n  upfence <- qv[4] + mult * iqr\r\n  lofence <- qv[2] - mult * iqr\r\n  # initialize break points vector\r\n  bb <- vector(mode=\"numeric\",length=7)\r\n  # logic for lower and upper fences\r\n  if (lofence < qv[1]) {# no lower outliers\r\n    bb[1] <- lofence\r\n    bb[2] <- floor(qv[1])\r\n  } else {\r\n    bb[2] <- lofence\r\n    bb[1] <- qv[1]\r\n  }\r\n  if (upfence > qv[5]) {# no upper outliers\r\n    bb[7] <- upfence\r\n    bb[6] <- ceiling(qv[5])\r\n  } else {\r\n    bb[6] <- upfence\r\n    bb[7] <- qv[5]\r\n  }\r\n  bb[3:5] <- qv[2:4]\r\n  return(bb)\r\n}\r\n\r\n\r\n\r\nCreating get variable function\r\n\r\n\r\nget.var <- function(vname,df) {\r\n  v <- df[vname] %>%\r\n    st_set_geometry(NULL)\r\n  v <- unname(v[,1])\r\n  return(v)\r\n}\r\n\r\n\r\n\r\nTesting the Boxbreaks Function on AGED using mpsz_pop2020 will result in error.\r\nSince missing values and NaN’s are not allowed, we will exclude AGED = NA\r\n\r\n\r\nmpsz_pop2020b <- mpsz_pop2020 %>%\r\n  filter(AGED>=0)\r\nvar <- get.var(\"AGED\", mpsz_pop2020b)\r\nboxbreaks(var)\r\n\r\n\r\n[1] -4330     0   515  2080  3745  8590 20240\r\n\r\nBoxmap Function\r\n\r\n\r\nboxmap <- function(vnam, df, \r\n                   legtitle=NA,\r\n                   mtitle=\"Box Map\",\r\n                   mult=1.5){\r\n  var <- get.var(vnam,df)\r\n  bb <- boxbreaks(var)\r\n  tm_shape(df) +\r\n     tm_fill(vnam,title=legtitle,\r\n             breaks=bb,\r\n             palette=\"Blues\",\r\n          labels = c(\"lower outlier\", \r\n                     \"< 25%\", \r\n                     \"25% - 50%\", \r\n                     \"50% - 75%\",\r\n                     \"> 75%\", \r\n                     \"upper outlier\"))  +\r\n  tm_borders() +\r\n  tm_layout(title = mtitle, \r\n            title.position = c(\"right\",\r\n                               \"bottom\"))\r\n}\r\n\r\n\r\n\r\nTesting Boxmap function (AGED)\r\n\r\n\r\nboxmap(\"AGED\", mpsz_pop2020b)\r\n\r\n\r\n\r\n\r\nBoxmap Function (Missing Area Fix)\r\n\r\n\r\nboxmap <- function(vnam, df, \r\n                   legtitle=NA,\r\n                   mtitle=\"Box Map\",\r\n                   mult=1.5){\r\n  var <- get.var(vnam,df)\r\n  bb <- boxbreaks(var)\r\n  tm_shape(mpsz_pop2020) +\r\n  tm_polygons() +\r\n  tm_shape(df) +\r\n     tm_fill(vnam,title=legtitle,\r\n             breaks=bb,\r\n             palette=\"Blues\",\r\n          labels = c(\"lower outlier\", \r\n                     \"< 25%\", \r\n                     \"25% - 50%\", \r\n                     \"50% - 75%\",\r\n                     \"> 75%\", \r\n                     \"upper outlier\"))  +\r\n  tm_borders() +\r\n  tm_layout(title = mtitle, \r\n            title.position = c(\"right\",\r\n                               \"bottom\"))\r\n}\r\n\r\n\r\n\r\nTesting Boxmap function (AGED)\r\n\r\n\r\nboxmap(\"AGED\", mpsz_pop2020b)\r\n\r\n\r\n\r\n\r\nRaw Rate Map\r\n\r\nCompute raw rate\r\n\r\n\r\nmpsz_pop2020c <- mpsz_pop2020 %>%\r\n  mutate(`AGED%` = (`AGED`/`TOTAL`)*100) %>%\r\n  filter(`AGED%` >= 0)\r\n\r\n\r\n\r\nPlot Raw rate map using Boxmap function\r\n\r\n\r\nvar <- get.var(\"AGED%\", mpsz_pop2020c)\r\nboxbreaks(var)\r\n\r\n\r\n[1] -2.17276  0.00000 11.28169 16.48199 20.25132 33.70576 95.00000\r\n\r\nboxmap(\"AGED%\",mpsz_pop2020c)\r\n\r\n\r\n\r\n\r\nRelative Risk Map\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-08-30-in-class-exercise-3/in-class-exercise-3_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-08-30T19:55:17+08:00",
    "input_file": "in-class-exercise-3.knit.md"
  },
  {
    "path": "posts/2021-08-23-in-class-exercise-2/",
    "title": "In-class Exercise 2",
    "description": "In this hands-on exercise, I learn how to handle geospatial data in R by using sf package.",
    "author": [
      {
        "name": "Kwek Yi Chen",
        "url": "https://example.com/kwekyichen"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\nGetting Started\r\nThis code chunk performs three tasks:\r\ncreate a list of R packages needed.\r\n\r\n\r\npackages <- c('sf', 'tidyverse')\r\nfor(p in packages){\r\n  if(!require(p, character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-23T11:29:01+08:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to IS415 blog",
    "description": "Welcome to our new blog, IS415 blog. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Kwek Yi Chen",
        "url": "https://example.com/kwekyichen"
      }
    ],
    "date": "2021-08-23",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-08-23T09:42:38+08:00",
    "input_file": {}
  }
]
